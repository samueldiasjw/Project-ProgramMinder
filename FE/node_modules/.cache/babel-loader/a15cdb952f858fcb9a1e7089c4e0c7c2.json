{"ast":null,"code":"var _jsxFileName = \"/Users/samueldias/Desktop/MyProjectMindera/src/homepage/Components/Posts.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { useParams, Link, useHistory } from \"react-router-dom\";\nimport { Jumbotron, Container, Image } from \"react-bootstrap\";\nimport styles from \"../CSS/Posts.module.css\";\nimport { CKEditor } from '@ckeditor/ckeditor5-react';\nimport ClassicEditor from '@ckeditor/ckeditor5-build-classic';\nimport parse from \"html-react-parser\";\nimport { useSelector } from \"react-redux\";\nimport NotAccess from \"./NotAccess\";\nexport default function Posts() {\n  const {\n    id\n  } = useParams();\n  const history = useHistory();\n  const [posts, setPosts] = useState([]);\n  const [thread, setThread] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [text, setText] = useState(\"\");\n  const [editorDeTexto, setEditorDeTexto] = useState(\"\");\n  const user = useSelector(store => store.users);\n  console.log(user.userId);\n  var myHeaders = new Headers();\n  myHeaders.append(\"Authorization\", document.cookie.split(\"token=\")[1]);\n  var requestOptions = {\n    method: 'GET',\n    headers: myHeaders,\n    redirect: 'follow'\n  };\n  useEffect(() => {\n    fetch(`http://localhost:8080/posts/${id}`, requestOptions).then(response => {\n      return response.json();\n    }).then(data => {\n      setPosts(data || []);\n    }).catch(error => {\n      console.log(\"ERRRORRR\");\n    });\n    fetch(`http://localhost:8080/threads/getthread/${id}`, requestOptions).then(response => {\n      return response.json();\n    }).then(data => {\n      setThread(data || []);\n    });\n    fetch(`http://localhost:8080/users/${id}`, requestOptions).then(response => {\n      return response.json();\n    }).then(data => {\n      setUsers(data || []);\n    });\n  }, [id]);\n\n  function sendPost(e) {\n    e.preventDefault();\n    var postHeader = new Headers();\n    postHeader.append(\"Content-Type\", \"application/json\");\n    postHeader.append(\"Authorization\", document.cookie.split(\"token=\")[1]);\n    var raw = JSON.stringify({\n      \"post\": text,\n      \"userId\": user.userId,\n      \"threadId\": id\n    });\n    var postRequestOptions = {\n      method: 'POST',\n      headers: postHeader,\n      body: raw,\n      redirect: 'follow'\n    };\n    fetch(\"http://localhost:8080/posts\", postRequestOptions).then(response => response.text()).then(result => {\n      editorDeTexto.setData(\"\");\n      setText(\"\");\n      fetch(`http://localhost:8080/posts/${id}`, requestOptions).then(response => {\n        return response.json();\n      }).then(data => {\n        setPosts(data || []);\n      }).catch(error => {\n        console.log(\"ERRRORRR\");\n      });\n      fetch(`http://localhost:8080/threads/getthread/${id}`, requestOptions).then(response => {\n        return response.json();\n      }).then(data => {\n        setThread(data || []);\n      });\n      fetch(`http://localhost:8080/users/${id}`, requestOptions).then(response => {\n        return response.json();\n      }).then(data => {\n        setUsers(data || []);\n      });\n    }).catch(error => console.log('error', error));\n  }\n\n  function quote(myString) {\n    editorDeTexto.setData(\"<blockquote><p>\" + myString + \"</p></blockquote><p>&nbsp;</p>\");\n    setText(\"<blockquote><p>\" + myString + \"</p></blockquote><p>&nbsp;</p>\");\n  }\n\n  return /*#__PURE__*/React.createElement(Jumbotron, {\n    id: \"about\",\n    className: styles.Jumbotron,\n    fluid: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }, document.cookie.split(\"token=\")[1] ? /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.card,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: styles.heading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    key: thread.threadId,\n    className: styles.Us,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, thread.title)), /*#__PURE__*/React.createElement(\"div\", {\n    key: thread.threadId,\n    className: styles.cardPost,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.userInformation,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: users[0] !== undefined ? users[0].photo : \"\",\n    alt: \"Account Image\",\n    className: styles.image,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 21\n    }\n  }), users[0] !== undefined ? /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.userInfo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 47\n    }\n  }, \" \", /*#__PURE__*/React.createElement(Link, {\n    className: styles.link,\n    to: `/account/${users[0].userId}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 79\n    }\n  }, users[0].avatarName), \" \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 173\n    }\n  }), \" \", /*#__PURE__*/React.createElement(\"span\", {\n    className: styles.tagRole + ' ' + styles[users[0].role],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 179\n    }\n  }, users[0].role), \" \") : \"\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: styles.postText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  }, parse(\"\" + thread.post))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#reply\",\n    className: styles.Reply,\n    onClick: () => quote(\"<b>\" + users[0].avatarName + \" say:</b><p>\" + thread.post + \"</p>\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 21\n    }\n  }, \"\\u201CReply\"))), posts.length > 0 ? posts.map((post, index) => {\n    {\n      index = index + 1;\n    }\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: post.postId,\n      className: styles.cardPost,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: styles.userInformation,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Image, {\n      src: users[index] !== undefined ? users[index].photo : \"\",\n      alt: \"Account Image\",\n      className: styles.image,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 21\n      }\n    }), users[index] !== undefined ? /*#__PURE__*/React.createElement(\"p\", {\n      className: styles.userInfo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 51\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: styles.link,\n      to: `/account/${users[index].userId}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 82\n      }\n    }, users[index].avatarName), \" \", /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 184\n      }\n    }), \" \", /*#__PURE__*/React.createElement(\"span\", {\n      className: styles.tagRole + ' ' + styles[users[index].role],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 190\n      }\n    }, users[index].role), \" \") : \"\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: styles.postText,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 21\n      }\n    }, parse(post.post))), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#reply\",\n      className: styles.Reply,\n      onClick: () => quote(\"<b>\" + users[index].avatarName + \" say:</b><p>\" + post.post + \"</p>\"),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 21\n      }\n    }, \"\\u201CReply\")));\n  }) : console.log(\"DONT HAVE MORE POSTS\"), /*#__PURE__*/React.createElement(\"a\", {\n    name: \"reply\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.richtext,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CKEditor, {\n    editor: ClassicEditor,\n    data: \"<p>Write your reply...</p>\",\n    onReady: editor => {\n      console.log(editor.ui.view.toolbar);\n      setEditorDeTexto(editor);\n    },\n    onChange: (event, editor) => {\n      const data = editor.getData();\n      setText(data);\n    },\n    onFocus: (event, editor) => {\n      const data = editor.getData();\n\n      if (data === \"<p>Write your reply...</p>\") {\n        editor.setData(\"\");\n        setText(\"\");\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    className: styles.createButton,\n    onClick: sendPost,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }\n  }, \"+ Post Reply\"))) : /*#__PURE__*/React.createElement(NotAccess, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 18\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.lineGrade,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["/Users/samueldias/Desktop/MyProjectMindera/src/homepage/Components/Posts.js"],"names":["React","useEffect","useState","useParams","Link","useHistory","Jumbotron","Container","Image","styles","CKEditor","ClassicEditor","parse","useSelector","NotAccess","Posts","id","history","posts","setPosts","thread","setThread","users","setUsers","text","setText","editorDeTexto","setEditorDeTexto","user","store","console","log","userId","myHeaders","Headers","append","document","cookie","split","requestOptions","method","headers","redirect","fetch","then","response","json","data","catch","error","sendPost","e","preventDefault","postHeader","raw","JSON","stringify","postRequestOptions","body","result","setData","quote","myString","card","heading","threadId","Us","title","cardPost","userInformation","undefined","photo","image","userInfo","link","avatarName","tagRole","role","postText","post","Reply","length","map","index","postId","richtext","editor","ui","view","toolbar","event","getData","createButton","lineGrade"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams, Link, useHistory } from \"react-router-dom\";\nimport { Jumbotron, Container, Image} from \"react-bootstrap\";\nimport styles from \"../CSS/Posts.module.css\";\n\nimport { CKEditor } from '@ckeditor/ckeditor5-react';\nimport ClassicEditor from '@ckeditor/ckeditor5-build-classic';\nimport parse from \"html-react-parser\";\n\nimport { useSelector } from \"react-redux\";\n\nimport NotAccess from \"./NotAccess\"\n\n\nexport default function Posts() {\n  const { id } = useParams();\n  const history = useHistory();\n  const [posts, setPosts] = useState([]);\n  const [thread, setThread] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [text, setText] = useState(\"\");\n\n\n  const [editorDeTexto, setEditorDeTexto] = useState(\"\");\n\n  const user = useSelector(store => store.users);\n\n  console.log(user.userId)\n  \n\n\n  var myHeaders = new Headers();\n  myHeaders.append(\"Authorization\", document.cookie.split(\"token=\")[1]);\n\n  var requestOptions = {\n    method: 'GET',\n    headers: myHeaders,\n    redirect: 'follow'\n  };\n\n\n  useEffect( () => {\n    fetch(`http://localhost:8080/posts/${id}`, requestOptions)\n    .then((response) => {\n      return response.json()\n    })\n    .then((data) => {\n      setPosts(data || [])\n    }) \n    .catch ((error) =>{\n        console.log(\"ERRRORRR\")\n    })\n\n    fetch(`http://localhost:8080/threads/getthread/${id}`, requestOptions)\n        .then((response) => {\n          return response.json()\n        })\n        .then((data) => {\n          setThread(data || [])\n        })\n\n    fetch(`http://localhost:8080/users/${id}`, requestOptions)\n        .then((response) => {\n          return response.json()\n        })\n        .then((data) => {\n          setUsers(data || [])\n        })\n    \n  }, [id])\n\n  function sendPost(e) {\n    e.preventDefault();\n\n\n    var postHeader = new Headers();\n    postHeader.append(\"Content-Type\", \"application/json\");\n    postHeader.append(\"Authorization\", document.cookie.split(\"token=\")[1]);\n    \n    var raw = JSON.stringify({\"post\": text,\"userId\":user.userId,\"threadId\":id});\n    \n    var postRequestOptions = {\n      method: 'POST',\n      headers: postHeader,\n      body: raw,\n      redirect: 'follow'\n    };\n    \n    fetch(\"http://localhost:8080/posts\", postRequestOptions)\n      .then(response => response.text())\n      .then(result => {\n        editorDeTexto.setData(\"\");\n        setText(\"\")\n        fetch(`http://localhost:8080/posts/${id}`, requestOptions)\n          .then((response) => {\n            return response.json()\n          })\n          .then((data) => {\n            setPosts(data || [])\n          }) \n          .catch ((error) =>{\n              console.log(\"ERRRORRR\")\n          })\n\n        fetch(`http://localhost:8080/threads/getthread/${id}`, requestOptions)\n          .then((response) => {\n            return response.json()\n          })\n          .then((data) => {\n            setThread(data || [])\n          })\n  \n        fetch(`http://localhost:8080/users/${id}`, requestOptions)\n          .then((response) => {\n            return response.json()\n          })\n          .then((data) => {\n            setUsers(data || [])\n          })\n      })\n      .catch(error => console.log('error', error));\n  }\n\n  function quote(myString){\n    editorDeTexto.setData(\"<blockquote><p>\" + myString + \"</p></blockquote><p>&nbsp;</p>\");\n    setText(\"<blockquote><p>\" + myString + \"</p></blockquote><p>&nbsp;</p>\");\n  }\n\n  return (\n    <Jumbotron id=\"about\" className={styles.Jumbotron} fluid>\n      <Container>\n        {document.cookie.split(\"token=\")[1] ?\n          <div className={styles.card}>\n          <h1 className={styles.heading}>\n            <span key={thread.threadId} className={styles.Us}>{thread.title}</span>\n          </h1>\n                <div key={thread.threadId} className={styles.cardPost}>\n                  <div className={styles.userInformation}>\n                    <Image src={users[0] !== undefined ? users[0].photo : \"\"} alt=\"Account Image\" className={styles.image}></Image>\n                    {users[0] !== undefined ? <p className={styles.userInfo}> <Link className={styles.link} to={`/account/${users[0].userId}`}>{users[0].avatarName}</Link> <br/> <span className={styles.tagRole + ' ' + styles[users[0].role]}>{users[0].role}</span> </p> : \"\"}\n                  </div>\n                  <div>\n                    <p className={styles.postText}>{parse(\"\" + thread.post)}</p>\n                  </div>\n                  <div>\n                    <a href = \"#reply\" className = {styles.Reply} onClick={() => quote(\"<b>\" + users[0].avatarName + \" say:</b><p>\" + thread.post + \"</p>\")}>\n                      &#8220;Reply\n                    </a>\n                  </div>\n                </div>\n\n            {posts.length > 0 ? posts.map((post, index) =>{\n              {index= index + 1}\n              return(\n                <div key={post.postId} className={styles.cardPost}>\n                  <div className={styles.userInformation}>\n                    <Image src={users[index] !== undefined ? users[index].photo : \"\"} alt=\"Account Image\" className={styles.image}></Image>\n                    {users[index] !== undefined ? <p className={styles.userInfo}><Link className={styles.link} to={`/account/${users[index].userId}`}>{users[index].avatarName}</Link> <br/> <span className={styles.tagRole + ' ' + styles[users[index].role]}>{users[index].role}</span> </p> : \"\"}\n                  </div>\n                  <div>\n                    <p className={styles.postText}>{parse(post.post)}</p>\n                  </div>\n                  <div>\n                    <a href = \"#reply\" className = {styles.Reply} onClick={() => quote(\"<b>\" + users[index].avatarName + \" say:</b><p>\" + post.post + \"</p>\")}>\n                      &#8220;Reply\n                    </a>\n                  </div>\n                </div>\n              )\n            }):console.log(\"DONT HAVE MORE POSTS\")\n            }\n\n            <a name=\"reply\"></a>\n\n            <div className = {styles.richtext}>\n              <CKEditor\n                      editor={ ClassicEditor }\n                      data=\"<p>Write your reply...</p>\"\n                      onReady={ editor => {\n                        console.log(editor.ui.view.toolbar);\n                        setEditorDeTexto(editor);\n                      }}\n                      onChange={ ( event, editor ) => {\n                        const data = editor.getData();\n\n                        setText(data)\n                      } }\n                      onFocus={ ( event, editor ) => {\n                          const data = editor.getData();\n\n                          if(data === \"<p>Write your reply...</p>\"){\n                            editor.setData(\"\");\n                            setText(\"\")\n                          }\n                      } }\n              />\n              <a href = \"#\" className = {styles.createButton} onClick={sendPost}>\n                + Post Reply\n              </a>\n            </div>\n        </div> : <NotAccess/>\n        }\n        \n      </Container>\n      <div className={styles.lineGrade} ></div>\n    </Jumbotron>\n  );\n}\n\n"]},"metadata":{},"sourceType":"module"}